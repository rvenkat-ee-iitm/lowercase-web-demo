<!DOCTYPE html>
<html>
<head>
    <title>English Quiz</title>

    <script>
        async function loadQuestion() {
            const res = await fetch("/question");
            const data = await res.json();

            if (data.done) {
                const r = await fetch("/result");
                const result = await r.json();
                document.body.innerHTML =
                    `<h2>Final Score: ${result.score} / ${result.total}</h2>`;
                return;
            }

            document.getElementById("qno").innerText =
                `Question ${data.number} of ${data.total}`;
            document.getElementById("question").innerText = data.question;

            const opts = document.getElementById("options");
            opts.innerHTML = "";

            for (const key in data.options) {
                const btn = document.createElement("button");
                btn.innerText = `${key}) ${data.options[key]}`;
                btn.onclick = () => submitAnswer(key);
                opts.appendChild(btn);
                opts.appendChild(document.createElement("br"));
            }
        }

        async function submitAnswer(choice) {
            await fetch("/answer", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ answer: choice })
            });
            loadQuestion();
        }

        window.onload = loadQuestion;
    </script>
</head>

<body>
    <h2 id="qno"></h2>
    <p id="question"></p>
    <div id="options"></div>
</body>
</html>

